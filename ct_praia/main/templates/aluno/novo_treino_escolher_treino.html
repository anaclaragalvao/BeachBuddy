{% extends "base.html" %}
{% block title %}Escolher Treino{% endblock %}
{% block body_class %}aluno-page{% endblock %}
{% block content %}
<section class="aluno-header">
    <div>
        <h1>{{ ct.nome }} · Treinos</h1>
        <p>Selecione um treino para confirmar presença.</p>
    </div>
    <div class="aluno-actions">
        <a href="{% url 'novo_treino_ct' %}" class="btn btn-outline">Voltar</a>
    </div>
</section>

{% if treinos %}
<div class="wizard-grid">
    {% for t in treinos %}
    <article class="wizard-card">
        <h2>{{ t.modalidade }}</h2>
        <p><strong>Data:</strong> {{ t.data|date:"d/m/Y" }}<br>
            <strong>Hora:</strong> {{ t.hora_inicio|time:"H:i" }} - {{ t.hora_fim|time:"H:i" }}<br>
            <strong>Nível:</strong> {{ t.nivel }}
        </p>
        <p>
            <span class="badge">{{ t.confirmadas }} / {{ t.vagas }} vagas</span>
            {% if t.id in inscritos_ids %}
            <span class="badge-secondary">Inscrito</span>
            {% elif t.confirmadas >= t.vagas %}
            <span class="badge-danger">Lotado</span>
            {% endif %}
        </p>
        <footer>
            {% if t.id in inscritos_ids %}
            <em style="font-size:.75rem; color: var(--bb-muted);">Você já está inscrito.</em>
            {% elif t.confirmadas >= t.vagas %}
            <em style="font-size:.75rem; color: var(--bb-muted);">Sem vagas disponíveis.</em>
            {% else %}
            <form method="post" action="{% url 'inscricao_criar' t.pk %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm">Confirmar presença</button>
            </form>
            {% endif %}
        </footer>
    </article>
    {% endfor %}
</div>
{% else %}
<div class="empty-box">
    <h2>Nenhum treino disponível</h2>
    <p>Volte mais tarde para verificar novos treinos neste centro.</p>
    <a href="{% url 'novo_treino_ct' %}" class="btn btn-outline">Voltar</a>
</div>
{% endif %}
{% endblock %}